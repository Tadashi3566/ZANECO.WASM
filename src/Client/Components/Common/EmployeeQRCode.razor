@using Syncfusion.Blazor.BarcodeGenerator

<MudGrid Class="d-flex flex-column" Spacing="5">
    <MudPaper Class="ma-5" Elevation="25">
        @if (_employeeId is not null)
        {
            <SfQRCodeGenerator Width="350px" Height="300px" Value="@_employeeId">
                <QRCodeGeneratorDisplayText Text="@_name"></QRCodeGeneratorDisplayText>
            </SfQRCodeGenerator>
        }
    </MudPaper>
    <MudPaper Class="ma-5" Elevation="25">
        @if (_sandurotId is not null)
        {
            <SfBarcodeGenerator Width="350px" Height="250px" Value="@_sandurotId">
                <BarcodeGeneratorDisplayText Text="@_name"></BarcodeGeneratorDisplayText>
            </SfBarcodeGenerator>
        }
    </MudPaper>
</MudGrid>

@code {
    [Inject]
    protected IPersonalClient Client { get; set; } = default!;

    private UserDetailsDto? userDto = new();

    private string? _employeeId;
    private string? _sandurotId;
    private string _name = string.Empty;
    private bool _isLoaded;

    protected override async Task OnInitializedAsync()
    {
        var userDto = await Client.GetProfileAsync();
        if (userDto is not null)
        {
            _name = $"{userDto.FirstName} {userDto.LastName}";

            if (userDto.EmployeeId is not null)
            {
                _employeeId = userDto.EmployeeId.ToString();
            }
            if (userDto.SandurotId is not null)
            {
                _sandurotId = userDto.SandurotId.ToString();
            }
        }
        
        _isLoaded = true;
        StateHasChanged();
    }
}